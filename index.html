<html>
<head>
    <title>A camera experiment</title>
    <meta http-equiv="content-type" content="text/html;charset=utf-8">
</head>

<body>
    <video id="video" width="300" height="300"></video>
    <button id="button" type="button" >Snaps!</button>
    <canvas id="canvas" style="display:none;" width="300" height="300"></canvas>
</body>

<script>
    
    // Vendor prefixes ahead!
    navigator.getUserMedia = (navigator.getUserMedia || 
                              navigator.webkitGetUserMedia || 
                              navigator.mozGetUserMedia || 
                              navigator.msGetUserMedia);

    
    if (!navigator.getUserMedia){
        alert('Sorry, the browser you are using doesn\'t support getUserMedia');
    } else {
        alert('Navigator.getUserMedia present, please continue');
        debugger;
        navigator.getUserMedia({"video": true}, 
            function(stream) {   
                // we have a stream         
                var video = document.getElementById('video'),
                    button = document.getElementById('button'),
                    canvas = document.getElementById('canvas'),
                    url = window.URL || window.webkitURL;

                video.src = url ? url.createObjectURL(stream) : stream;
                video.play();

                button.onClick = function() {
                    canvas.getContext("2d").drawImage(video, 0, 0, 300, 300, 0, 0, 300, 300);
                    var img = canvas.toDataURL("image/png");
                };
            },
            function (error) { console.log('Nuh uh! ', error) }
        );
    }

</script>
</html>
